(()=>{var t={n:e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e);const n=flarum.core.compat["common/app"];var r=t.n(n);const a=flarum.core.compat["common/extend"],s=flarum.core.compat["forum/components/LogInModal"];var o=t.n(s);const i=flarum.core.compat["forum/components/SignUpModal"];var u=t.n(i);const c=flarum.core.compat["common/utils/Stream"];var h=t.n(c),l="glowingblue-password-strength";function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function p(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,f(t,e)}const d=flarum.core.compat["common/Component"];var g=t.n(d);const v=flarum.core.compat["common/utils/extractText"];var b=t.n(v);const y=flarum.core.compat["common/helpers/icon"];var w=t.n(y),k=function(t){function e(){return t.apply(this,arguments)||this}p(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e)},n.view=function(){var t=this.attrs.showing;return m("span",{className:"EyeButton",onclick:function(){return t(!t())}},w()("fas fa-eye"+(t()?"-slash":"")))},e}(g()),M=app.translator.trans.bind(app.translator),x=function(t){function e(){return t.apply(this,arguments)||this}p(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e)},n.view=function(){var t=this.attrs,e=t.parent_this,n=t.showingPassword;return m("div",{className:"Form-group PasswordField"},m("input",{className:"FormControl togglable",name:"password",type:n()?"text":"password",placeholder:b()(M("core.forum.log_in.password_placeholder")),bidi:e.password,disabled:e.loading}),m(k,{showing:n}))},e}(g());function j(){return j=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},j.apply(this,arguments)}var S=function(t,e){return t.push.apply(t,e)},T=function(t){return t.sort((function(t,e){return t.i-e.i||t.j-e.j}))},I=function(t){var e={},n=1;return t.forEach((function(t){e[t]=n,n+=1})),e},P={4:[[1,2],[2,3]],5:[[1,3],[2,3]],6:[[1,2],[2,4],[4,5]],7:[[1,3],[2,3],[4,5],[4,6]],8:[[2,4],[4,6]]},C=/^[A-Z\xbf-\xdf][^A-Z\xbf-\xdf]+$/,E=/^[^A-Z\xbf-\xdf]+[A-Z\xbf-\xdf]$/,O=/^[A-Z\xbf-\xdf]+$/,A=/^[^a-z\xdf-\xff]+$/,N=/^[a-z\xdf-\xff]+$/,D=/^[^A-Z\xbf-\xdf]+$/,L=/[a-z\xdf-\xff]/,F=/[A-Z\xbf-\xdf]/,_=/[^A-Za-z\xbf-\xdf]/gi,q=/^\d+$/,Y=(new Date).getFullYear(),G={recentYear:/19\d\d|200\d|201\d|202\d/g},R=function(){function t(){}var e=t.prototype;return e.match=function(t){var e=t.password,n=[].concat(this.getMatchesWithoutSeparator(e),this.getMatchesWithSeparator(e)),r=this.filterNoise(n);return T(r)},e.getMatchesWithSeparator=function(t){for(var e=[],n=/^(\d{1,4})([\s/\\_.-])(\d{1,2})\2(\d{1,4})$/,r=0;r<=Math.abs(t.length-6);r+=1)for(var a=r+5;a<=r+9&&!(a>=t.length);a+=1){var s=t.slice(r,+a+1||9e9),o=n.exec(s);if(null!=o){var i=this.mapIntegersToDayMonthYear([parseInt(o[1],10),parseInt(o[3],10),parseInt(o[4],10)]);null!=i&&e.push({pattern:"date",token:s,i:r,j:a,separator:o[2],year:i.year,month:i.month,day:i.day})}}return e},e.getMatchesWithoutSeparator=function(t){for(var e=this,n=[],r=/^\d{4,8}$/,a=function(t){return Math.abs(t.year-Y)},s=0;s<=Math.abs(t.length-4);s+=1)for(var o=function(o){if(o>=t.length)return"break";var i=t.slice(s,+o+1||9e9);if(r.exec(i)){var u=[],c=i.length;if(P[c].forEach((function(t){var n=t[0],r=t[1],a=e.mapIntegersToDayMonthYear([parseInt(i.slice(0,n),10),parseInt(i.slice(n,r),10),parseInt(i.slice(r),10)]);null!=a&&u.push(a)})),u.length>0){var h=u[0],l=a(u[0]);u.slice(1).forEach((function(t){var e=a(t);e<l&&(h=t,l=e)})),n.push({pattern:"date",token:i,i:s,j:o,separator:"",year:h.year,month:h.month,day:h.day})}}},i=s+3;i<=s+7&&"break"!==o(i);i+=1);return n},e.filterNoise=function(t){return t.filter((function(e){for(var n=!1,r=t.length,a=0;a<r;a+=1){var s=t[a];if(e!==s&&s.i<=e.i&&s.j>=e.j){n=!0;break}}return!n}))},e.mapIntegersToDayMonthYear=function(t){if(t[1]>31||t[1]<=0)return null;for(var e=0,n=0,r=0,a=0,s=t.length;a<s;a+=1){var o=t[a];if(o>99&&o<1e3||o>2050)return null;o>31&&(n+=1),o>12&&(e+=1),o<=0&&(r+=1)}return n>=2||3===e||r>=2?null:this.getDayMonth(t)},e.getDayMonth=function(t){for(var e=[[t[2],t.slice(0,2)],[t[0],t.slice(1,3)]],n=e.length,r=0;r<n;r+=1){var a=e[r],s=a[0],o=a[1];if(1e3<=s&&s<=2050){var i=this.mapIntegersToDayMonth(o);return null!=i?{year:s,month:i.month,day:i.day}:null}}for(var u=0;u<n;u+=1){var c=e[u],h=c[0],l=c[1],f=this.mapIntegersToDayMonth(l);if(null!=f)return{year:this.twoToFourDigitYear(h),month:f.month,day:f.day}}return null},e.mapIntegersToDayMonth=function(t){for(var e=[t,t.slice().reverse()],n=0;n<e.length;n+=1){var r=e[n],a=r[0],s=r[1];if(a>=1&&a<=31&&s>=1&&s<=12)return{day:a,month:s}}return null},e.twoToFourDigitYear=function(t){return t>99?t:t>50?t+1900:t+2e3},t}(),W={a:["4","@"],b:["8"],c:["(","{","[","<"],e:["3"],g:["6","9"],i:["1","!","|"],l:["1","|","7"],o:["0"],s:["$","5"],t:["+","7"],x:["%"],z:["2"]},z={warnings:{straightRow:"straightRow",keyPattern:"keyPattern",simpleRepeat:"simpleRepeat",extendedRepeat:"extendedRepeat",sequences:"sequences",recentYears:"recentYears",dates:"dates",topTen:"topTen",topHundred:"topHundred",common:"common",similarToCommon:"similarToCommon",wordByItself:"wordByItself",namesByThemselves:"namesByThemselves",commonNames:"commonNames",userInputs:"userInputs"},suggestions:{l33t:"l33t",reverseWords:"reverseWords",allUppercase:"allUppercase",capitalization:"capitalization",dates:"dates",recentYears:"recentYears",associatedYears:"associatedYears",sequences:"sequences",repeated:"repeated",longerKeyboardPattern:"longerKeyboardPattern",anotherWord:"anotherWord",useWords:"useWords",noNeed:"noNeed"},timeEstimation:{ltSecond:"ltSecond",second:"second",seconds:"seconds",minute:"minute",minutes:"minutes",hour:"hour",hours:"hours",day:"day",days:"days",month:"month",months:"months",year:"year",years:"years",centuries:"centuries"}},B=new(function(){function t(){this.matchers={},this.l33tTable=W,this.dictionary={userInputs:[]},this.rankedDictionaries={},this.translations=z,this.graphs={},this.availableGraphs=[],this.setRankedDictionaries()}var e=t.prototype;return e.setOptions=function(t){void 0===t&&(t={}),t.l33tTable&&(this.l33tTable=t.l33tTable),t.dictionary&&(this.dictionary=t.dictionary,this.setRankedDictionaries()),t.translations&&this.setTranslations(t.translations),t.graphs&&(this.graphs=t.graphs)},e.setTranslations=function(t){if(!this.checkCustomTranslations(t))throw new Error("Invalid translations object fallback to keys");this.translations=t},e.checkCustomTranslations=function(t){var e=!0;return Object.keys(z).forEach((function(n){if(n in t){var r=n;Object.keys(z[r]).forEach((function(n){n in t[r]||(e=!1)}))}else e=!1})),e},e.setRankedDictionaries=function(){var t=this,e={};Object.keys(this.dictionary).forEach((function(n){e[n]=t.getRankedDictionary(n)})),this.rankedDictionaries=e},e.getRankedDictionary=function(t){var e=this.dictionary[t];if("userInputs"===t){var n=[];return e.forEach((function(t){var e=typeof t;"string"!==e&&"number"!==e&&"boolean"!==e||n.push(t.toString().toLowerCase())})),I(n)}return I(e)},e.extendUserInputsDictionary=function(t){this.dictionary.userInputs?this.dictionary.userInputs=[].concat(this.dictionary.userInputs,t):this.dictionary.userInputs=t,this.rankedDictionaries.userInputs=this.getRankedDictionary("userInputs")},e.addMatcher=function(t,e){this.matchers[t]?console.info("Matcher already exists"):this.matchers[t]=e},t}()),H=function(){function t(t){this.defaultMatch=t}return t.prototype.match=function(t){var e=t.password,n=e.split("").reverse().join("");return this.defaultMatch({password:n}).map((function(t){return j({},t,{token:t.token.split("").reverse().join(""),reversed:!0,i:e.length-1-t.j,j:e.length-1-t.i})}))},t}(),$=function(){function t(t){this.defaultMatch=t}var e=t.prototype;return e.match=function(t){for(var e=this,n=t.password,r=[],a=this.enumerateL33tSubs(this.relevantL33tSubtable(n,B.l33tTable)),s=function(t){var s,o=a[t];if(s=o,0===Object.keys(s).length)return"break";var i,u=(i=o,n.split("").map((function(t){return i[t]||t})).join(""));e.defaultMatch({password:u}).forEach((function(t){var e=n.slice(t.i,+t.j+1||9e9);if(e.toLowerCase()!==t.matchedWord){var a={};Object.keys(o).forEach((function(t){var n=o[t];-1!==e.indexOf(t)&&(a[t]=n)}));var s=Object.keys(a).map((function(t){return t+" -> "+a[t]})).join(", ");r.push(j({},t,{l33t:!0,token:e,sub:a,subDisplay:s}))}}))},o=0;o<a.length&&"break"!==s(o);o+=1);return r.filter((function(t){return t.token.length>1}))},e.relevantL33tSubtable=function(t,e){var n={},r={};return t.split("").forEach((function(t){n[t]=!0})),Object.keys(e).forEach((function(t){var a=e[t].filter((function(t){return t in n}));a.length>0&&(r[t]=a)})),r},e.enumerateL33tSubs=function(t){var e=Object.keys(t);return this.getSubs(e,[[]],t).map((function(t){var e={};return t.forEach((function(t){var n=t[0],r=t[1];e[n]=r})),e}))},e.getSubs=function(t,e,n){if(!t.length)return e;var r=t[0],a=t.slice(1),s=[];n[r].forEach((function(t){e.forEach((function(e){for(var n=-1,a=0;a<e.length;a+=1)if(e[a][0]===t){n=a;break}if(-1===n){var o=e.concat([[t,r]]);s.push(o)}else{var i=e.slice(0);i.splice(n,1),i.push([t,r]),s.push(e),s.push(i)}}))}));var o=this.dedup(s);return a.length?this.getSubs(a,o,n):o},e.dedup=function(t){var e=[],n={};return t.forEach((function(t){var r=t.map((function(t,e){return[t,e]}));r.sort();var a=r.map((function(t){return t[0]+","+t[1]})).join("-");a in n||(n[a]=!0,e.push(t))})),e},t}(),U=function(){function t(){this.l33t=new $(this.defaultMatch),this.reverse=new H(this.defaultMatch)}var e=t.prototype;return e.match=function(t){var e=t.password,n=[].concat(this.defaultMatch({password:e}),this.reverse.match({password:e}),this.l33t.match({password:e}));return T(n)},e.defaultMatch=function(t){var e=t.password,n=[],r=e.length,a=e.toLowerCase();return Object.keys(B.rankedDictionaries).forEach((function(t){for(var s=B.rankedDictionaries[t],o=0;o<r;o+=1)for(var i=o;i<r;i+=1)if(a.slice(o,+i+1||9e9)in s){var u=a.slice(o,+i+1||9e9),c=s[u];n.push({pattern:"dictionary",i:o,j:i,token:e.slice(o,+i+1||9e9),matchedWord:u,rank:c,dictionaryName:t,reversed:!1,l33t:!1})}})),n},t}(),Z=function(){function t(){}return t.prototype.match=function(t){var e=t.password,n=t.regexes,r=void 0===n?G:n,a=[];return Object.keys(r).forEach((function(t){var n=r[t];n.lastIndex=0;var s=n.exec(e);if(s){var o=s[0];a.push({pattern:"regex",token:o,i:s.index,j:s.index+s[0].length-1,regexName:t,regexMatch:s})}})),T(a)},t}(),V=function(t,e){var n=t;if(e>n)return 0;if(0===e)return 1;for(var r=1,a=1;a<=e;a+=1)r*=n,r/=a,n-=1;return r},X=function(t){return Math.log(t)/Math.log(10)},K={bruteforce:function(t){var e,n=t.token,r=Math.pow(10,n.length);return r===Number.POSITIVE_INFINITY&&(r=Number.MAX_VALUE),e=1===n.length?11:51,Math.max(r,e)},date:function(t){var e=t.year,n=t.separator,r=365*Math.max(Math.abs(e-Y),20);return n&&(r*=4),r},dictionary:function(t){var e=t.rank,n=t.reversed,r=t.l33t,a=t.sub,s=t.token,o=e,i=function(t){var e=t.replace(_,"");if(e.match(D)||e.toLowerCase()===e)return 1;for(var n=[C,E,A],r=n.length,a=0;a<r;a+=1){var s=n[a];if(e.match(s))return 2}return function(t){for(var e=t.split(""),n=e.filter((function(t){return t.match(L)})).length,r=e.filter((function(t){return t.match(F)})).length,a=0,s=Math.min(n,r),o=1;o<=s;o+=1)a+=V(n+r,o);return a}(e)}(s),u=function(t){var e=t.token;if(!t.l33t)return 1;var n=1,r=t.sub;return Object.keys(r).forEach((function(t){var a=function(t){var e=t.subbed,n=t.token,r=t.subs[e],a=n.toLowerCase().split("");return{subbedCount:a.filter((function(t){return t===e})).length,unsubbedCount:a.filter((function(t){return t===r})).length}}({subs:r,subbed:t,token:e}),s=a.subbedCount,o=a.unsubbedCount;if(0===s||0===o)n*=2;else{for(var i=Math.min(o,s),u=0,c=1;c<=i;c+=1)u+=V(o+s,c);n*=u}})),n}({l33t:r,sub:a,token:s});return{baseGuesses:o,uppercaseVariations:i,l33tVariations:u,calculation:o*i*u*(n?2:1)}},regex:function(t){var e=t.regexName,n=t.regexMatch,r=t.token,a={alphaLower:26,alphaUpper:26,alpha:52,alphanumeric:62,digits:10,symbols:33};return e in a?Math.pow(a[e],r.length):"recentYear"===e?Math.max(Math.abs(parseInt(n[0],10)-Y),20):0},repeat:function(t){return t.baseGuesses*t.repeatCount},sequence:function(t){var e=t.token,n=t.ascending,r=e.charAt(0),a=0;return a=["a","A","z","Z","0","1","9"].includes(r)?4:r.match(/\d/)?10:26,n||(a*=2),a*e.length},spatial:function(t){var e=t.graph,n=t.token,r=t.shiftedCount,a=function(t){for(var e=t.token,n=t.graph,r=t.turns,a=Object.keys(B.graphs[n]).length,s=function(t){var e=0;return Object.keys(t).forEach((function(n){var r=t[n];e+=r.filter((function(t){return!!t})).length})),e/=Object.entries(t).length}(B.graphs[n]),o=0,i=e.length,u=2;u<=i;u+=1)for(var c=Math.min(r,u-1),h=1;h<=c;h+=1)o+=V(u-1,h-1)*a*Math.pow(s,h);return o}({token:n,graph:e,turns:t.turns});if(r){var s=n.length-r;if(0===r||0===s)a*=2;else{for(var o=0,i=1;i<=Math.min(r,s);i+=1)o+=V(r+s,i);a*=o}}return Math.round(a)}},J={password:"",optimal:{},excludeAdditive:!1,fillArray:function(t,e){for(var n=[],r=0;r<t;r+=1){var a=[];"object"===e&&(a={}),n.push(a)}return n},makeBruteforceMatch:function(t,e){return{pattern:"bruteforce",token:this.password.slice(t,+e+1||9e9),i:t,j:e}},update:function(t,e){var n=this,r=t.j,a=function(t,e){var n={};if("guesses"in t&&null!=t.guesses)return t;var r=function(t,e){var n=1;return t.token.length<e.length&&(n=1===t.token.length?10:50),n}(t,e),a=function(t,e){return K[t]?K[t](e):B.matchers[t]&&"scoring"in B.matchers[t]?B.matchers[t].scoring(e):0}(t.pattern,t),s=0;"number"==typeof a?s=a:"dictionary"===t.pattern&&(s=a.calculation,n.baseGuesses=a.baseGuesses,n.uppercaseVariations=a.uppercaseVariations,n.l33tVariations=a.l33tVariations);var o=Math.max(s,r);return j({},t,n,{guesses:o,guessesLog10:X(o)})}(t,this.password),s=a.guesses;e>1&&(s*=this.optimal.pi[a.i-1][e-1]);var o=function(t){for(var e=1,n=2;n<=t;n+=1)e*=n;return e}(e)*s;this.excludeAdditive||(o+=Math.pow(1e4,e-1));var i=!1;Object.keys(this.optimal.g[r]).forEach((function(t){var a=n.optimal.g[r][t];parseInt(t,10)<=e&&a<=o&&(i=!0)})),i||(this.optimal.g[r][e]=o,this.optimal.m[r][e]=a,this.optimal.pi[r][e]=s)},bruteforceUpdate:function(t){var e=this,n=this.makeBruteforceMatch(0,t);this.update(n,1);for(var r=function(r){n=e.makeBruteforceMatch(r,t);var a=e.optimal.m[r-1];Object.keys(a).forEach((function(t){"bruteforce"!==a[t].pattern&&e.update(n,parseInt(t,10)+1)}))},a=1;a<=t;a+=1)r(a)},unwind:function(t){var e=[],n=t-1,r=0,a=Infinity,s=this.optimal.g[n];for(s&&Object.keys(s).forEach((function(t){var e=s[t];e<a&&(r=parseInt(t,10),a=e)}));n>=0;){var o=this.optimal.m[n][r];e.unshift(o),n=o.i-1,r-=1}return e}},Q={mostGuessableMatchSequence:function(t,e,n){void 0===n&&(n=!1),J.password=t,J.excludeAdditive=n;var r=t.length,a=J.fillArray(r,"array");e.forEach((function(t){a[t.j].push(t)})),a=a.map((function(t){return t.sort((function(t,e){return t.i-e.i}))})),J.optimal={m:J.fillArray(r,"object"),pi:J.fillArray(r,"object"),g:J.fillArray(r,"object")};for(var s=0;s<r;s+=1)a[s].forEach((function(t){t.i>0?Object.keys(J.optimal.m[t.i-1]).forEach((function(e){J.update(t,parseInt(e,10)+1)})):J.update(t,1)})),J.bruteforceUpdate(s);var o=J.unwind(r),i=o.length,u=this.getGuesses(t,i);return{password:t,guesses:u,guessesLog10:X(u),sequence:o}},getGuesses:function(t,e){var n=t.length;return 0===t.length?1:J.optimal.g[n-1][e]}},tt=function(){function t(){}var e=t.prototype;return e.match=function(t){for(var e=t.password,n=t.omniMatch,r=[],a=0;a<e.length;){var s=this.getGreedyMatch(e,a),o=this.getLazyMatch(e,a);if(null==s)break;var i=this.setMatchToken(s,o),u=i.match,c=i.baseToken;if(u){var h=u.index+u[0].length-1,l=this.getBaseGuesses(c,n);r.push(this.normalizeMatch(c,h,u,l)),a=h+1}}var f=r.some((function(t){return t instanceof Promise}));return f?Promise.all(r):r},e.normalizeMatch=function(t,e,n,r){var a={pattern:"repeat",i:n.index,j:e,token:n[0],baseToken:t,baseGuesses:0,repeatCount:n[0].length/t.length};return r instanceof Promise?r.then((function(t){return j({},a,{baseGuesses:t})})):j({},a,{baseGuesses:r})},e.getGreedyMatch=function(t,e){var n=/(.+)\1+/g;return n.lastIndex=e,n.exec(t)},e.getLazyMatch=function(t,e){var n=/(.+?)\1+/g;return n.lastIndex=e,n.exec(t)},e.setMatchToken=function(t,e){var n,r="";if(e&&t[0].length>e[0].length){var a=/^(.+?)\1+$/.exec((n=t)[0]);a&&(r=a[1])}else(n=e)&&(r=n[1]);return{match:n,baseToken:r}},e.getBaseGuesses=function(t,e){var n=e.match(t);return n instanceof Promise?n.then((function(e){return Q.mostGuessableMatchSequence(t,e).guesses})):Q.mostGuessableMatchSequence(t,n).guesses},t}(),et=function(){function t(){this.MAX_DELTA=5}var e=t.prototype;return e.match=function(t){var e=t.password,n=[];if(1===e.length)return[];for(var r=0,a=null,s=e.length,o=1;o<s;o+=1){var i=e.charCodeAt(o)-e.charCodeAt(o-1);if(null==a&&(a=i),i!==a){var u=o-1;this.update({i:r,j:u,delta:a,password:e,result:n}),r=u,a=i}}return this.update({i:r,j:s-1,delta:a,password:e,result:n}),n},e.update=function(t){var e=t.i,n=t.j,r=t.delta,a=t.password,s=t.result;if(n-e>1||1===Math.abs(r)){var o=Math.abs(r);if(o>0&&o<=this.MAX_DELTA){var i=a.slice(e,+n+1||9e9),u=this.getSequence(i),c=u.sequenceName,h=u.sequenceSpace;return s.push({pattern:"sequence",i:e,j:n,token:a.slice(e,+n+1||9e9),sequenceName:c,sequenceSpace:h,ascending:r>0})}}return null},e.getSequence=function(t){var e="unicode",n=26;return N.test(t)?(e="lower",n=26):O.test(t)?(e="upper",n=26):q.test(t)&&(e="digits",n=10),{sequenceName:e,sequenceSpace:n}},t}(),nt=function(){function t(){this.SHIFTED_RX=/[~!@#$%^&*()_+QWERTYUIOP{}|ASDFGHJKL:"ZXCVBNM<>?]/}var e=t.prototype;return e.match=function(t){var e=this,n=t.password,r=[];return Object.keys(B.graphs).forEach((function(t){var a=B.graphs[t];S(r,e.helper(n,a,t))})),T(r)},e.checkIfShifted=function(t,e,n){return!t.includes("keypad")&&this.SHIFTED_RX.test(e.charAt(n))?1:0},e.helper=function(t,e,n){for(var r,a=[],s=0,o=t.length;s<o-1;){var i=s+1,u=0,c=0;for(r=this.checkIfShifted(n,t,s);;){var h=e[t.charAt(i-1)]||[],l=!1,f=-1,p=-1;if(i<o)for(var d=t.charAt(i),g=h.length,m=0;m<g;m+=1){var v=h[m];if(p+=1,v){var b=v.indexOf(d);if(-1!==b){l=!0,1===b&&(r+=1),u!==(f=p)&&(c+=1,u=f);break}}}if(!l){i-s>2&&a.push({pattern:"spatial",i:s,j:i-1,token:t.slice(s,i),graph:n,turns:c,shiftedCount:r}),s=i;break}i+=1}}return a},t}(),rt=function(){function t(){this.matchers={date:R,dictionary:U,regex:Z,repeat:tt,sequence:et,spatial:nt}}return t.prototype.match=function(t){var e=this,n=[],r=[];return[].concat(Object.keys(this.matchers),Object.keys(B.matchers)).forEach((function(a){if(e.matchers[a]||B.matchers[a]){var s=(new(e.matchers[a]?e.matchers[a]:B.matchers[a].Matching)).match({password:t,omniMatch:e});s instanceof Promise?(s.then((function(t){S(n,t)})),r.push(s)):S(n,s)}})),r.length>0?new Promise((function(t){Promise.all(r).then((function(){t(T(n))}))})):T(n)},t}(),at={second:1,minute:60,hour:3600,day:86400,month:2678400,year:32140800,century:321408e4},st=function(){function t(){}var e=t.prototype;return e.translate=function(t,e){var n=t;return void 0!==e&&1!==e&&(n+="s"),B.translations.timeEstimation[n].replace("{base}",""+e)},e.estimateAttackTimes=function(t){var e=this,n={onlineThrottling100PerHour:t/(100/3600),onlineNoThrottling10PerSecond:t/10,offlineSlowHashing1e4PerSecond:t/1e4,offlineFastHashing1e10PerSecond:t/1e10},r={onlineThrottling100PerHour:"",onlineNoThrottling10PerSecond:"",offlineSlowHashing1e4PerSecond:"",offlineFastHashing1e10PerSecond:""};return Object.keys(n).forEach((function(t){var a=n[t];r[t]=e.displayTime(a)})),{crackTimesSeconds:n,crackTimesDisplay:r,score:this.guessesToScore(t)}},e.guessesToScore=function(t){return t<1005?0:t<1000005?1:t<100000005?2:t<10000000005?3:4},e.displayTime=function(t){var e,n="centuries",r=Object.keys(at),a=r.findIndex((function(e){return t<at[e]}));return a>-1&&(n=r[a-1],0!==a?e=Math.round(t/at[n]):n="ltSecond"),this.translate(n,e)},t}(),ot=function(){return null},it=function(){return{warning:B.translations.warnings.dates,suggestions:[B.translations.suggestions.dates]}},ut=function(t,e){var n=function(t,e){var n="",r=t.dictionaryName,a="lastnames"===r||r.toLowerCase().includes("firstnames");return"passwords"===r?n=function(t,e){var n="";return!e||t.l33t||t.reversed?t.guessesLog10<=4&&(n=B.translations.warnings.similarToCommon):n=t.rank<=10?B.translations.warnings.topTen:t.rank<=100?B.translations.warnings.topHundred:B.translations.warnings.common,n}(t,e):r.includes("wikipedia")?n=function(t,e){var n="";return e&&(n=B.translations.warnings.wordByItself),n}(0,e):a?n=function(t,e){return e?B.translations.warnings.namesByThemselves:B.translations.warnings.commonNames}(0,e):"userInputs"===r&&(n=B.translations.warnings.userInputs),n}(t,e),r=[],a=t.token;return a.match(C)?r.push(B.translations.suggestions.capitalization):a.match(A)&&a.toLowerCase()!==a&&r.push(B.translations.suggestions.allUppercase),t.reversed&&t.token.length>=4&&r.push(B.translations.suggestions.reverseWords),t.l33t&&r.push(B.translations.suggestions.l33t),{warning:n,suggestions:r}},ct=function(t){return"recentYear"===t.regexName?{warning:B.translations.warnings.recentYears,suggestions:[B.translations.suggestions.recentYears,B.translations.suggestions.associatedYears]}:{warning:"",suggestions:[]}},ht=function(t){var e=B.translations.warnings.extendedRepeat;return 1===t.baseToken.length&&(e=B.translations.warnings.simpleRepeat),{warning:e,suggestions:[B.translations.suggestions.repeated]}},lt=function(){return{warning:B.translations.warnings.sequences,suggestions:[B.translations.suggestions.sequences]}},ft=function(t){var e=B.translations.warnings.keyPattern;return 1===t.turns&&(e=B.translations.warnings.straightRow),{warning:e,suggestions:[B.translations.suggestions.longerKeyboardPattern]}},pt={warning:"",suggestions:[]},dt=function(){function t(){this.matchers={bruteforce:ot,date:it,dictionary:ut,regex:ct,repeat:ht,sequence:lt,spatial:ft},this.defaultFeedback={warning:"",suggestions:[]},this.setDefaultSuggestions()}var e=t.prototype;return e.setDefaultSuggestions=function(){this.defaultFeedback.suggestions.push(B.translations.suggestions.useWords,B.translations.suggestions.noNeed)},e.getFeedback=function(t,e){if(0===e.length)return this.defaultFeedback;if(t>2)return pt;var n=B.translations.suggestions.anotherWord,r=this.getLongestMatch(e),a=this.getMatchFeedback(r,1===e.length);return null!=a?(a.suggestions.unshift(n),null==a.warning&&(a.warning="")):a={warning:"",suggestions:[n]},a},e.getLongestMatch=function(t){var e=t[0];return t.slice(1).forEach((function(t){t.token.length>e.token.length&&(e=t)})),e},e.getMatchFeedback=function(t,e){return this.matchers[t.pattern]?this.matchers[t.pattern](t,e):B.matchers[t.pattern]&&"feedback"in B.matchers[t.pattern]?B.matchers[t.pattern].feedback(t,e):pt},t}(),gt=function(){return(new Date).getTime()},mt=function(t,e,n){var r=new dt,a=new st,s=Q.mostGuessableMatchSequence(e,t),o=gt()-n,i=a.estimateAttackTimes(s.guesses);return j({calcTime:o},s,i,{feedback:r.getFeedback(i.score,s.sequence)})},vt=function(t){function e(){return t.apply(this,arguments)||this}p(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e)},n.view=function(){var t=this,e=this.attrs,n=e.label,r=e.color;return m("div",{className:"StrengthIndicator "+(n?"active":"")},m("div",{className:"StrengthIndicator-container"},m("div",{className:"StrengthIndicator-pills"},["weak","medium","strong"].map((function(e){return m(bt,{color:r,active:t.isPillActive(e)})}))),m("div",{className:"StrengthIndicator-label"},m("span",null,n))))},n.isPillActive=function(t){var e=this.attrs.score;switch(t){case"weak":if(Number.isInteger(e))return!0;case"medium":if(e>=2)return!0;case"strong":if(e>=4)return!0;default:return!1}},e}(g()),bt=function(t){function e(){return t.apply(this,arguments)||this}return p(e,t),e.prototype.view=function(){var t=this.attrs,e=t.color,n=t.active;return m("div",{className:"StrengthPill",style:{backgroundColor:n?e:void 0}})},e}(g()),yt=app.translator.trans.bind(app.translator),wt=l+".forum.strengthLabels",kt=function(t){return app.forum.attribute(l+"."+t)},Mt=function(t){function e(){return t.apply(this,arguments)||this}p(e,t);var n=e.prototype;return n.oninit=function(e){t.prototype.oninit.call(this,e),this.strengthLabel=new(h())(""),this.passwordScore=new(h())(void 0),this.strengthColor=new(h())("")},n.view=function(){var t=this.attrs,e=t.parent_this,n=t.showingPassword,r=t.hasConfirmFiled,a=t.isConfirmFiled;return m("div",{className:"Form-group PasswordField"},m("input",{className:"FormControl "+(kt("enablePasswordToggle")?"togglable":""),name:a?"confirmPassword":"password",type:n()?"text":"password",placeholder:a?yt("nearata-signup-confirm-password.forum.field_placeholder"):b()(yt("core.forum.sign_up.password_placeholder")),value:a?e.confirmPassword():e.password(),disabled:e.loading,oninput:this.inputHandler.bind(this),style:{color:!kt("enableInputColor")||n()||r&&!a?void 0:this.strengthColor(),borderColor:!kt("enableInputBorderColor")||r&&!a?void 0:this.strengthColor()}}),kt("enablePasswordToggle")?m(k,{showing:n}):null,!r||a?m(vt,{score:this.passwordScore(),label:this.strengthLabel(),color:this.strengthColor()}):null)},n.inputHandler=function(t){var e=this.attrs,n=e.parent_this,r=e.isConfirmFiled,a=t.target.value;if(r?n.confirmPassword(a):n.password(a),a){var s=function(t,e){var n=new rt,r=gt(),a=n.match(t);return a instanceof Promise?a.then((function(e){return mt(e,t,r)})):mt(a,t,r)}(a),o=s.score;switch(this.passwordScore(o),o){case 0:case 1:this.strengthLabel(yt(wt+".weak")),this.strengthColor("rgb("+kt("weakColor")+")");break;case 2:case 3:this.strengthLabel(yt(wt+".medium")),this.strengthColor("rgb("+kt("mediumColor")+")");break;case 4:this.strengthLabel(yt(wt+".strong")),this.strengthColor("rgb("+kt("strongColor")+")")}}else this.passwordScore(void 0),this.strengthLabel(""),this.strengthColor(void 0)},e}(g());r().initializers.add(l,(function(){function t(){this.showingPassword=new(h())(!1)}(0,a.extend)(o().prototype,"oninit",t),(0,a.extend)(u().prototype,"oninit",t),(0,a.extend)(o().prototype,"fields",(function(t){r().forum.attribute(l+".enablePasswordToggle")&&t.has("password")&&t.setContent("password",m(x,{parent_this:this,showingPassword:this.showingPassword.bind(this)}))})),(0,a.extend)(u().prototype,"fields",(function(t){if(!this.attrs.token){var e=t.has("nearataConfirmPassword")&&void 0!==this.confirmPassword;t.setContent("password",m(Mt,{parent_this:this,showingPassword:this.showingPassword.bind(this),hasConfirmFiled:e})),e&&t.setContent("nearataConfirmPassword",m(Mt,{parent_this:this,showingPassword:this.showingPassword.bind(this),hasConfirmFiled:e,isConfirmFiled:!0}))}}))}))})(),module.exports=e})();
//# sourceMappingURL=forum.js.map